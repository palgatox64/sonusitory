{% extends request.htmx|yesno:"_base_empty.html,base.html" %}
{% load static %}

{% block content %}
    {% csrf_token %}
    <h1>Tus Playlists</h1>
    
    <div class="action-bar">
        <p>
            <a href="{% url 'folder_browser' %}" 
               hx-get="{% url 'folder_browser' %}" 
               hx-target=".main-content" 
               hx-push-url="true" 
               class="btn">
                Volver a la Biblioteca
            </a>
            <button 
                id="create-playlist-btn" 
                class="btn">
                Crear Nueva Playlist
            </button>
        </p>
    </div>

    {% if playlists %}
        <div class="playlist-list">
            {% for playlist in playlists %}
                <a href="{% url 'playlist_detail' playlist_id=playlist.id %}"
                   hx-get="{% url 'playlist_detail' playlist_id=playlist.id %}"
                   hx-target=".main-content"
                   hx-push-url="true">
                    <div class="playlist-cover-container">
                        <div class="cover-placeholder"></div>
                        <img
                            src="{% if playlist.cover_image_url %}{{ playlist.cover_image_url }}{% else %}{% static 'images/default_cover.png' %}{% endif %}"
                            alt="{{ playlist.name }}"
                            class="playlist-cover"
                            onload="this.style.display='block'; this.previousElementSibling.style.display='none';">
                    </div>
                    <div class="playlist-info">
                        <h3 class="playlist-name">{{ playlist.name }}</h3>
                        <p class="playlist-count">{{ playlist.songs.count }} pistas</p>
                    </div>
                </a>
            {% endfor %}
        </div>
    {% else %}
        <p>No tienes playlists aún. ¡Crea tu primera playlist!</p>
    {% endif %}
{% endblock %}